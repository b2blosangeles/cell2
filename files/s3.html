<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
<script src="/package/ioCommunication.js"></script>
<script src="/js/TSocketClient.js"></script>
<script>
  var tSocket = new TSocketClient();

    tSocket.addEvent('clientMessage', function(data){
        var clientInfo = (data.clientInfo) ?  JSON.parse(decodeURIComponent(data.clientInfo)) : {};
        if (data.code === 'joinRoom') {
            console.log( 'Welcome ' +  clientInfo.id);
        } else {
          var obj = JSON.parse(decodeURIComponent(data.data))
          
          console.log(clientInfo.id + ':' + obj.text);
        }
      });

   tSocket.addEvent('disconnect', function (data) {

        console.log('user disconnected==>' + tSocket.socket.id);
        console.log(data);
        console.log('<--user disconnected');
    });

    tSocket.addEvent( 'roomCilents', function(data){
          for (o in data) {
            data[o] = (data[o]) ?  JSON.parse(decodeURIComponent(data[o])) : {};
          }
            console.log('===== hubRoomCilents=====>>>');
            console.log(data);
            console.log('<<<----- hubRoomCilents---');
    }); 
 
  tSocket.connection('//68.183.49.110/?_code=eda.js&param=as',
 // tSocket.connection('//comm1_dev.shusiou.win/?_code=eda.js&param=as',
    function() {
        tSocket.joinRoom('PPQ', {id: 'a3A'});
        tSocket.sendToRoom('PPQ', {text : 'Thanks!'}, {id: 'a66A'});
          
       // tSocket.query();
      //  tSocket.disConnect();
    }                  
  );

  /*
  var clients = {NNBB : []};
  const socket = io('//comm1_dev.shusiou.win/?_code=eda.js&param=as');
  */
  /*
  socket.on('connect', function(){
      console.log('--connnected-b->');
      console.log(socket.id);
  
      socket.emit('clientRequest', {
            cmd : 'sendToRoom',
            room : 'NNBB',
            data : {
              client_id : 1,
              user_name : 'John Xu',
              text : encodeURIComponent('how are you')
            }
          }, (data) => {
            console.log(data); // data will be 'woot'
          });
    
      socket.on('hubRoomCilents', function(data){
        console.log('---hubRoomCilents--->');
        console.log(data);
      });       

      getUniqueId(socket, function(uuid) {
        console.log(uuid);
      });


              socket.emit('clientRequest', {cmd: 'roomClients', room : 'NNBB'}, (data) => {}); 

    
      socket.on('clientMessage', function(data){
          console.log('=====clientMessage=====>>>');
          console.log( decodeURIComponent(data.data.text));
          console.log('<<<-----clientMessage---');
      
      });


    
      socket.on('clientRequestCBK', function(data){
          console.log('=====clientRequestCBK=====>>>');
          console.log(data);
          console.log('<<<-----clientRequestCBK---');
      
      });
  
      socket.on('ioAppError', function(data){
          console.log('------ioAppError------>>>');
          console.log(data);
          console.log('<<<------------');
      
      });
    
  });
*/
function getRoomClients() {
  //  tSocket.setupEvent();
  //  tSocket.setClientId('niuB');
   // setTimeout(
   //   function() {
            tSocket.emit('clientRequest', {cmd: 'roomClients', room : 'PPQ'});
   //   }, 2000
  //  );

}

</script>
<link rel="stylesheet" href="/package/Tao.css">
</head>
<body>
<div class="container bg-light">
  <div class="row">
    <div class="col-sm-12 p-0 pl-2 pr-2" id="topMenu">
      <a href="javascript:void(0)" onClick="getRoomClients()">getRoomClient</a>
      <hr/>
      <a href="javascript:void(0)" onClick="tSocket.setClientInfo({id: 'AK88'})">set Client id</a>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-3 p-0 pl-2 pr-1" id="leftBox"></div>
    <div class="col-sm-9 p-0 pl-1 pr-2" id="rightBox"></div>
  </div>
</div>
</body>
</html>

